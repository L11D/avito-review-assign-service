# avito-review-assign-service
Сервис назначения ревьюеров для Pull Request’ов

## Запуск
Для запуска достаточно выполнить `docker compose up`
Для запуск тестов `docker compose -f docker-compose.e2e.yml up --abort-on-container-exit`

## Схема БД
Использование **varchar** и тем более **text** в качестве primary key является плохой практикой, но избежать этого, используя предоставленный API не удалось. 

Для таблицы **teams** было принято решение использовать uuid primary key и поле name типа varchar(50) unique. Это позволило избежать записи команд с одинаковым именем, быстро находить команду по имени, так как при использовании unique автоматически создается индекс, а также иметь "нормальный" id. 

Для пользователей и pull request'ов поступить аналогично не удалось, так как в предоставленном API явно передается их id, а использование дополнительного id было бы слишком запутано. Для ускорения поиска этих сущностей было принято решение для id использовать varchar(50).

## Назначение ревьюверов
У каждого пользователя есть поле assign_rate, которое представляет собой количество вмерженых pull request'ов, где пользователь был назначен ревьювером. Для назначения ревьюверов добавленного pull request'а используются пользователи с наименьшем значением assign_rate. При мерже pull request'а у всех пользователей, назначенных ревьюверами, assign_rate инкрементируется.

## Ендпоинт статистики
`/statistic/users` - выдает частоту назначений пользователей в качестве ревьювера.